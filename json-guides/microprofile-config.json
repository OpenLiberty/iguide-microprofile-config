{
    "name": "MicroprofileConfig",
    "title": "Microprofile Config",
    "description": "Creating a unified config for your sources",
    "duration": "10 minutes",
    "audience": "developer",
    "repo": "https://github.com/OpenLiberty/iguide-microprofile-config",
    "steps": [
        {
            "name": "Intro",
            "title": "What you'll learn",
            "guide_duration" : "25 minutes",
            "description": [
              "temp"
            ]
        },
        {
            "name": "ConfigureViaInject",
            "title": "Configuring ConfigProperties through Injection",
            "description": [
                "Microprofile-Config provides ways to inject configured values into your beans using the <code>@Inject</code> and the <code>@ConfigProperty</code> qualifier"
            ],
            "instruction": [
                "Add the <code>@ConfigProperty(name=\"download-url\", defaultValue=\"ftp://music.com/us/download\")</code> on line 9, after the <code>private Config config</code> or click <action title='Configure inject using ConfigProperty' onclick=\"microprofileConfigCallBack.addConfigInjectButton(event)\"><b>@ConfigProperty(name=\"download-url\", defaultValue=\"ftp://music.com/us/download\")</b></action>. Then, click <action title='Save' onclick=\"microprofileConfigCallBack.saveButton(event)\"><b>Save</b></action> on the editor menu pane."
            ],
            "content":[
              {
                "displayType":"fileEditor",
                "fileName": "Music-download.java",
                "preload": [
                    "package com.music.download;",
                    "import javax.inject.Inject;",
                    "import org.eclipse.microprofile.config.Config;",
                    "import org.eclipse.microprofile.config.inject.ConfigProperty;",
                    "", 
                    "public class Music-download {",
                    "    @Inject",
                    "    private Config config;",
                    "",
                    "    private String downloadUrl;",
                    "}"                
                ],
                "readonly": [
                  {
                      "from": "1",
                      "to": "8"
                  },
                  {
                      "from": "10",
                      "to": "11"
                  }
                ],
                "save": true,
                "callback": "(function test(editor) {microprofileConfigCallBack.listenToEditorForInjectConfig(editor); })"
              }
            ]
        },
        {
            "name": "ConfigureDefaultConfigSources",
            "title": "Configuring ConfigProperties using Default ConfigSources",
            "description": [
                "A Microprofile-Config implementation must provide ConfigSources for the following data out of the box:",               
                "<ul><li>System properties (default ordinal=400).</li><li>Environment variables (default ordinal=300).</li><li>A ConfigSource for each property file META-INF/microprofile-config.properties found on the classpath. (default ordinal = 100).</li></ul>"
            ],
            "instruction": [
                "Empty instruction"           
            ],
            "content":[
              {
                "displayType":"webBrowser",
                "url": "https://music.com/download",
                "browserContent": "/guides/iguide-microprofile-config/html/interactive-guides/microprofile-config/download-from-injection.html",
                "callback": "(function test(webBrowser) {microprofileConfigCallBack.listenToBrowserForDefaultConfig(webBrowser); })"
              }
            ]
        },
        {
            "name": "ConfigurePropsFile",
            "title": "Configure using a Properties File",
            "description": [
                "In Websphere Liberty, you can provide a properties file as part of your packaged application. This properties file lets you specify configuration for overriding injected values.",
                "",
                "Add the download-url property to the microprofile-config.properties file to override the injected value of the download-url. The properties file contains settings with a default ordinal of 100 which overrides the injected properties with the same name. If a property appears in more than one source, then the property value from the source with the highest ordinal takes precedence. The download-url property in the microprofile-config.properties will be used because the injected default value is only used when no other config sources are provided."
            ],
            "instruction": [
                "Add the <code>download-url=ftp://music.com/canada/download</code> on line 1 or click <action title='Configure download-url in microprofile-config.properties' onclick=\"microprofileConfigCallBack.addPropToConfigProps(event)\"><b>download-url=ftp://music.com/canada/download</b></action>. Then, click <action title='Run' onclick=\"microprofileConfigCallBack.saveButton(event)\"><b>Run</b></action> on the editor menu pane.",
                "Click <action title='Refresh' onclick=\"microprofileConfigCallBack.refreshBrowserButton(event)\"><b>Refresh</b></action> in the following browser to see that the download-url in the microprofile-config.properties file is used.<br/>"
            ],
            "content":[
              {
                "displayType":"fileEditor",
                "fileName": "META-INF/microprofile-config.properties",
                "preload": [
                ],
                "save": false,
                "callback": "(function test(editor) {microprofileConfigCallBack.listenToEditorForPropConfig(editor); })"
              }, 
              {
                "displayType":"webBrowser",
                "url": "https://music.com/download",
                "browserContent": "/guides/iguide-microprofile-config/html/interactive-guides/microprofile-config/download-from-injection.html",
                "callback": "(function test(webBrowser) {microprofileConfigCallBack.listenToBrowserForPropFileConfig(webBrowser); })"
              }
            ]
        },
        {
            "name": "ConfigureAsEnvVar",
            "title": "Configuring as an Environment Variable",
            "description": [
                "In Websphere Liberty, environment variables can be configured in the ${server.config.dir}/server.env file to customize the Liberty environment.",
                "",
                "After you add your <code>/META-INF/microprofile-config.properties</code> file to override the download-url, add the download-url to the server.env file. The server.env contains the environment settings with the default ordinal of 300 which is higher than the 100 for the microprofile-config.properties. If a property appears in more than one source, then the property value from the source with the highest ordinal takes precedence. The download-url property in the server.env will be used."
            ],
            "instruction": [
              "Add the <code>download-url=ftp://music.com/asia/download</code> on line 2, after the WLP_SKIP_MAXPERMSIXE=true or click <action title='Configure download-url in server.env' onclick=\"microprofileConfigCallBack.addPropToServerEnvButton(event)\"><b>download-url=ftp://music.com/asia/download</b></action>. Then, click <action title='Run' onclick=\"microprofileConfigCallBack.saveButton(event)\"><b>Run</b></action> on the editor menu pane.",
              "Click <action title='Refresh' onclick=\"microprofileConfigCallBack.refreshBrowserButton(event)\"><b>Refresh</b></action> in the following browser to see the download-url in the server.env file is used.<br/>"
            ],
            "content":[
              {
                "displayType":"fileEditor",
                "fileName": "server.env",
                "preload": [
                    "WLP_SKIP_MAXPERMSIZE=true",
                    ""
                ],
                "readonly": [
                  {
                      "from": "1",
                      "to": "1"
                  }
                ],
                "save": false,
                "callback": "(function test(editor) {microprofileConfigCallBack.listenToEditorForServerEnv(editor); })"
              },
              {
                "displayType":"webBrowser",
                "url": "https://music.com/download",
                "browserContent": "/guides/iguide-microprofile-config/html/interactive-guides/microprofile-config/download-from-properties-file.html",
                "callback": "(function test(webBrowser) {microprofileConfigCallBack.listenToBrowserForServerEnvConfig(webBrowser); })"
              }
            ]
        }
    ]
}
